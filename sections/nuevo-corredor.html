<template class="task-template">
  <section id="nuevo-corredor-section" class="section js-section u-category-native-ui">
    <header class="communication">
      <div class="section-wrapper">
        <h1>
          <img class="section-icon" src="assets/img/programming.png">
          Nuevo Corredor
        </h1>
        <h3>Asegurese que todos los datos son correctos antes de guardar.</h3>
      </div>
    </header>
    
    <table columns="2">
      <tr class="trinput">
        <td>Nombre</td>
        <td class="tdinput"><input type="text" class="input" name="background" ></td>
      </tr>
      <tr class="trinput">
        <td>Apellido</td>
        <td class="tdinput"><input type="text" class="input" name="background" ></td>
      </tr>
      <tr class="trinput">
        <td>DNI</td>
        <td class="tdinput"><input type="text" class="input" name="background" ></td>
      </tr>
      <tr class="trinput">
        <td>Categoría</td>
        <td class="tdinput"><select id="select-categorias" style="float: right; width: 320px;" placeholder="Elegir Categoría..."></select></td>
      </tr>
    </table>



    <div style="text-align: center; margin-top:30px;">
      <button class="boton" id="limpiarBtn">Limpiar</button>
      <button class="boton" id="guardarbtn">Guardar</button>
    </div>
  </div>
  <script type="text/javascript">
    // <select id="select-tools"></select>
    var $select = $('#select-categorias').selectize({
      maxItems: 1,
      valueField: 'id',
      labelField: 'descripcion',
      searchField: 'descripcion',
      create: false
    });

    var selectize = $select[0].selectize;

    getCategorias(function (err, result){
      selectize.addOption(result);
      selectize.refreshOptions();

    });

    function getCategorias(callback){
      var mysql = require('mysql');
      var connection = mysql.createConnection({
        host     : 'localhost',
        user     : 'root',
        password : null,
        database : 'bicisoft'
      });

      connection.connect(function(err) {
        if(err){
          console.log(err.code);
          console.log(err.fatal);
        }
      });
      console.log("performing query");
      // Perform a query
      $query = 'SELECT * FROM categorias';
      connection.query($query, function(err, rows, fields) {
        if(err){
          console.log("An error ocurred performing the query.");
          console.log(err);
          return;
        }
        console.log("Query categorias succesfully executed");
        callback(err, rows);


      });

      // Close the connection
      connection.end(function(){
        // The connection has been closed
      });
    }

  </script>
</section>
</template>
